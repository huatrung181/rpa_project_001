<Activity mc:Ignorable="sap sap2010" x:Class="BachHoaXanh" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sc="clr-namespace:System.ComponentModel;assembly=System.ComponentModel.TypeConverter" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:uascw="clr-namespace:UiPath.Activities.System.Compression.Workflow;assembly=UiPath.System.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:upap="clr-namespace:UiPath.PDF.Activities.PDF;assembly=UiPath.PDF.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="file_error" Type="OutArgument(x:String)" />
    <x:Property Name="PathOutput" Type="OutArgument(x:String)" />
    <x:Property Name="CusName" Type="OutArgument(x:String)" />
    <x:Property Name="out_PONumber" Type="OutArgument(x:String)" />
    <x:Property Name="FileList" Type="OutArgument(scg:List(x:String))" />
  </x:Members>
  <VisualBasic.Settings>
    <x:Null />
  </VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1115,5828.5</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>BachHoaXanh_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="90">
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System</x:String>
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Security</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Activities.System.Compression.Workflow</x:String>
      <x:String>UiPath.Activities.System.Encode</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>UiPath.CSV</x:String>
      <x:String>UiPath.CSV.Activities</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.PDF.Activities</x:String>
      <x:String>UiPath.PDF.Activities.PDF</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Core</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Private.Xml</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Text.RegularExpressions</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">False</x:Boolean>
      <x:Boolean x:Key="ShouldCollapseAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Sequence DisplayName="BachHoaXanh" sap:VirtualizedContainerService.HintSize="920,5763.5" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="s:String[]" Name="FilePath" />
      <Variable x:TypeArguments="x:Int32" Name="int_PageDefault" />
      <Variable x:TypeArguments="x:Int32" Name="int_PageCount" />
      <Variable x:TypeArguments="x:String" Name="str_Text" />
      <Variable x:TypeArguments="x:String" Name="PONumber" />
      <Variable x:TypeArguments="x:String" Name="str_Date" />
      <Variable x:TypeArguments="x:String" Name="FileName" />
      <Variable x:TypeArguments="x:String" Name="str_ShipTo" />
      <Variable x:TypeArguments="s:String[]" Name="arr_ListItem" />
      <Variable x:TypeArguments="x:String" Name="PO_Table" />
      <Variable x:TypeArguments="s:String[]" Name="arr_Line" />
      <Variable x:TypeArguments="x:String" Name="STT" />
      <Variable x:TypeArguments="x:String" Name="Type" />
      <Variable x:TypeArguments="x:String" Name="DVT" />
      <Variable x:TypeArguments="x:String" Name="Soluong" />
      <Variable x:TypeArguments="x:String" Name="Dongia" />
      <Variable x:TypeArguments="x:String" Name="Dongiachietkhau" />
      <Variable x:TypeArguments="x:String" Name="VAT" />
      <Variable x:TypeArguments="x:String" Name="Thanhtien" />
      <Variable x:TypeArguments="x:String" Name="Note" />
      <Variable x:TypeArguments="x:String" Name="Barcode" />
      <Variable x:TypeArguments="x:String" Name="TenSP" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Output" />
      <Variable x:TypeArguments="s:DateTime" Name="DateTime" />
      <Variable x:TypeArguments="s:String[]" Name="FilePathZip" />
      <Variable x:TypeArguments="x:Int32" Name="int_Maxrow" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Template" />
      <Variable x:TypeArguments="s:String[]" Default="[{&quot;N&quot;,&quot;O&quot;,&quot;P&quot;,&quot;S&quot;,&quot;G&quot;,&quot;D&quot;,&quot;K&quot;,&quot;X&quot;,&quot;AN&quot;,&quot;J&quot;,&quot;Y&quot;}]" Name="arr_Column" />
      <Variable x:TypeArguments="x:Int32" Name="int_Count" />
      <Variable x:TypeArguments="x:String" Name="CusAgen" />
      <Variable x:TypeArguments="x:String" Name="dateTo" />
      <Variable x:TypeArguments="x:String" Name="s" />
      <Variable x:TypeArguments="x:Int32" Name="i" />
      <Variable x:TypeArguments="x:String" Name="path_error" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsPinned">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Assign sap:VirtualizedContainerService.HintSize="858,83" sap2010:WorkflowViewState.IdRef="Assign_1">
      <Assign.To>
        <OutArgument x:TypeArguments="x:String">[CusName]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="x:String">BachHoaXanh</InArgument>
      </Assign.Value>
    </Assign>
    <Assign sap:VirtualizedContainerService.HintSize="858,83" sap2010:WorkflowViewState.IdRef="Assign_406">
      <Assign.To>
        <OutArgument x:TypeArguments="scg:List(x:String)">[FileList]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="scg:List(x:String)">[new List(of String)]</InArgument>
      </Assign.Value>
    </Assign>
    <Assign sap:VirtualizedContainerService.HintSize="858,83" sap2010:WorkflowViewState.IdRef="Assign_77">
      <Assign.To>
        <OutArgument x:TypeArguments="s:String[]">[FilePathZip]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(in_Config("Folder_Path").ToString+"\"+Now.ToString("yyyyMM")+"\BHX\Input","*.zip")]</InArgument>
      </Assign.Value>
    </Assign>
    <If Condition="[FilePathZip.Count &gt; 0]" DisplayName="If Extract file zip" sap:VirtualizedContainerService.HintSize="858,911" sap2010:WorkflowViewState.IdRef="If_206">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsPinned">True</x:Boolean>
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <If.Then>
        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each // Unzip file" sap:VirtualizedContainerService.HintSize="410,728" sap2010:WorkflowViewState.IdRef="ForEach`1_27" Values="[FilePathZip]">
          <ui:ForEach.Body>
            <ActivityAction x:TypeArguments="x:String">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="x:String" Name="file" />
              </ActivityAction.Argument>
              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,540" sap2010:WorkflowViewState.IdRef="Sequence_379">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <uascw:ExtractFiles Content="{x:Null}" DestinationFolderInfo="{x:Null}" File="{x:Null}" Password="{x:Null}" CodePage="Default" DestinationFolder="[in_Config(&quot;Folder_Path&quot;).ToString+&quot;\&quot;+Now.ToString(&quot;yyyyMM&quot;)+&quot;\BHX\Input&quot;]" DisplayName="Extract/Unzip Files" ExtractToADedicatedFolder="False" FileToExtract="[file]" sap:VirtualizedContainerService.HintSize="334,210" sap2010:WorkflowViewState.IdRef="ExtractFiles_2" SkipUnsupportedFiles="False">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </uascw:ExtractFiles>
                <ui:DeleteFileX DisplayName="Delete File" sap:VirtualizedContainerService.HintSize="334,81" sap2010:WorkflowViewState.IdRef="DeleteFileX_4" Path="[Directory.GetFiles(in_Config(&quot;Folder_Path&quot;).ToString+&quot;\&quot;+Now.ToString(&quot;yyyyMM&quot;)+&quot;\BHX\Input&quot;,&quot;*.csv&quot;)(0)]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:DeleteFileX>
                <ui:DeleteFileX DisplayName="Delete File" sap:VirtualizedContainerService.HintSize="334,81" sap2010:WorkflowViewState.IdRef="DeleteFileX_5" Path="[file]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:DeleteFileX>
              </Sequence>
            </ActivityAction>
          </ui:ForEach.Body>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:ForEach>
      </If.Then>
      <If.Else>
        <Sequence DisplayName="" sap2010:WorkflowViewState.IdRef="Sequence_390" />
      </If.Else>
    </If>
    <Assign sap:VirtualizedContainerService.HintSize="858,83" sap2010:WorkflowViewState.IdRef="Assign_407">
      <Assign.To>
        <OutArgument x:TypeArguments="s:String[]">[FilePath]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(in_Config("Folder_Path").ToString+"\"+Now.ToString("yyyyMM")+"\BHX\Input")]</InArgument>
      </Assign.Value>
    </Assign>
    <ui:BuildDataTable DataTable="[dt_Output]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="858,60" sap2010:WorkflowViewState.IdRef="BuildDataTable_4" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Ma_x0020_san_x0020_pham&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Ten_x0020_san_x0020_pham&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;SL&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Don_x0020_gia&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;PO_x0020_Number&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Date&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Ship_x0020_to&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;CusCode&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;FileName&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;CusAgen&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;1000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;DRIVER&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;12&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsPinned">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:BuildDataTable>
    <If Condition="[FilePath.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="858,4109.5" sap2010:WorkflowViewState.IdRef="If_22">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <If.Then>
        <Sequence sap:VirtualizedContainerService.HintSize="824,3843.5" sap2010:WorkflowViewState.IdRef="Sequence_89">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="782,1480.5" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[FilePath]">
            <ui:ForEach.Body>
              <ActivityAction x:TypeArguments="x:String">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                </ActivityAction.Argument>
                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="748,1292.5" sap2010:WorkflowViewState.IdRef="Sequence_4">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign sap:VirtualizedContainerService.HintSize="706,83" sap2010:WorkflowViewState.IdRef="Assign_196">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[FileName]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[Now.ToString("ddMMyyyy_hhmmss")+"_"+file.Split("\"c).Last]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="706,1081.5" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <If Condition="[file.ToString.ToLower.Contains(&quot;.pdf&quot;)]" DisplayName="If trích xuất dữ liệu" sap:VirtualizedContainerService.HintSize="668,848.5" sap2010:WorkflowViewState.IdRef="If_204">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <Flowchart sap:VirtualizedContainerService.HintSize="634,665.5" sap2010:WorkflowViewState.IdRef="Flowchart_2">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                <av:PointCollection x:Key="ConnectorLocation">300,77.1666666666667 300,187.166666666667</av:PointCollection>
                                <x:Double x:Key="Height">628.333333333334</x:Double>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Flowchart.StartNode>
                              <x:Reference>__ReferenceID5</x:Reference>
                            </Flowchart.StartNode>
                            <FlowStep x:Name="__ReferenceID5">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">200,187.166666666667</av:Point>
                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">300,241.166666666667 300,289.833333333333</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <upap:GetPDFPageCount DisplayName="Get PDF Page Count" FileName="[file]" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="GetPDFPageCount_2" PageCount="[int_PageCount]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </upap:GetPDFPageCount>
                              <FlowStep.Next>
                                <FlowDecision x:Name="__ReferenceID1" Condition="[int_PageCount &gt; 1]" DisplayName="Page count &gt; 1" sap:VirtualizedContainerService.HintSize="87,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <av:Point x:Key="ShapeLocation">257,289.833333333333</av:Point>
                                      <av:Size x:Key="ShapeSize">87,87</av:Size>
                                      <av:PointCollection x:Key="TrueConnector">257,333.166666666666 227,333.166666666666 227,340.833333333333 207,340.833333333333</av:PointCollection>
                                      <av:PointCollection x:Key="FalseConnector">344,333.333333333333 374,333.333333333333 374,340 393,340</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <FlowDecision.True>
                                    <FlowStep x:Name="__ReferenceID2">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">7,298.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,83</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">107,381.5 107,490.666666666667 200,490.666666666667</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Sequence DisplayName="Read single page" sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="Sequence_338">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="3134,72" sap2010:WorkflowViewState.IdRef="WriteLine_4" Text="[&quot;Many page: &quot;+FileName]" />
                                        <Assign sap:VirtualizedContainerService.HintSize="3134,70" sap2010:WorkflowViewState.IdRef="Assign_203">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Int32">[int_PageDefault]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:InterruptibleDoWhile CurrentIndex="{x:Null}" Condition="[int_PageDefault &lt;= int_PageCount]" DisplayName="Do While" sap:VirtualizedContainerService.HintSize="3134,3548" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_2">
                                          <ui:InterruptibleDoWhile.Body>
                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="3098,3331" sap2010:WorkflowViewState.IdRef="Sequence_337">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ReadPDFText DisplayName="Read PDF Text" FileName="[file]" sap:VirtualizedContainerService.HintSize="3056,32" sap2010:WorkflowViewState.IdRef="ReadPDFText_4" PreserveFormatting="True" Range="[int_PageDefault.ToString]" Text="[str_Text]" />
                                              <ui:WriteTextFile File="{x:Null}" DisplayName="Write Text File" FileName="tex1t.txt" sap:VirtualizedContainerService.HintSize="3056,32" sap2010:WorkflowViewState.IdRef="WriteTextFile_1" Text="[str_Text]" />
                                              <If Condition="[int_PageDefault &gt; 1]" DisplayName="If lấy dữ liệu ngoài bảng" sap:VirtualizedContainerService.HintSize="3056,419" sap2010:WorkflowViewState.IdRef="If_126">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Else>
                                                  <If Condition="[str_Text.ToLower.Contains(&quot;kho ncc giao&quot;)]" DisplayName="If kiểm tra phần ngoài bảng" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_125">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence DisplayName="Lấy dữ liệu ngoài bảng - online" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_243">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Sequence DisplayName="PONumber" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_240">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_204">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Mã đơn hàng:")+"Mã đơn hàng:".Length + 1).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_205">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[PONumber.Substring(0,PONumber.IndexOf(Environment.NewLine)).Trim.Split(" "c)(0)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Sequence DisplayName="Date" sap:VirtualizedContainerService.HintSize="400,742" sap2010:WorkflowViewState.IdRef="Sequence_241">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_206">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Ngày đặt hàng:")+"Ngày đặt hàng:".Length + 1).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_207">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Date.Substring(0,str_Date.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_208">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="s:DateTime">[DateTime]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="s:DateTime">[DateTime.ParseExact(str_Date.Split(" "c)(0),"dd/MM/yyyy",System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_209">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[DateTime.ToString("yyyyMMdd")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_420">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[s]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[Regex.Replace(str_Text.Trim,"\s",String.Empty).ToString]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_421">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[dateTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">["Han_"+System.Text.RegularExpressions.Regex.Match(s, "(?&lt;=NgàyNCCgiaohàng:)\d{2}.\d{2}.\d{4}.\d.........").Value.ToString.Substring(11,5)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Sequence DisplayName="ShipTo" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_242">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_210">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Kho NCC giao")+"Kho NCC giao".Length).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_211">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_ShipTo.Substring(0,str_ShipTo.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_212">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(str_ShipTo," {2,}","|")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_213">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("|"c)(0).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Assign sap:VirtualizedContainerService.HintSize="400,70" sap2010:WorkflowViewState.IdRef="Assign_214">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[CusAgen]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("-"c)(0).trim]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="Lấy dữ liệu ngoài bảng - kho offline" sap:VirtualizedContainerService.HintSize="442,1182" sap2010:WorkflowViewState.IdRef="Sequence_247">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Sequence DisplayName="PONumber" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_244">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_215">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Mã đơn hàng:")+"Mã đơn hàng:".Length + 1).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_216">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[PONumber.Substring(0,PONumber.IndexOf(Environment.NewLine)).Trim.Split(" "c)(0)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Sequence DisplayName="Date" sap:VirtualizedContainerService.HintSize="400,742" sap2010:WorkflowViewState.IdRef="Sequence_245">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_217">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Ngày đặt hàng:")+"Ngày đặt hàng:".Length + 1).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_218">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Date.Substring(0,str_Date.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_219">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="s:DateTime">[DateTime]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="s:DateTime">[DateTime.ParseExact(str_Date.Split(" "c)(0),"dd/MM/yyyy",System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_220">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[DateTime.ToString("yyyyMMdd")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_422">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[s]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[Regex.Replace(str_Text.Trim,"\s",String.Empty).ToString]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_423">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[dateTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">["Han_"+System.Text.RegularExpressions.Regex.Match(s, "(?&lt;=NgàyNCCgiaohàng:)\d{2}.\d{2}.\d{4}.\d.........").Value.ToString.Substring(11,5)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Sequence DisplayName="ShipTo" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_246">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_221">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Kho nhận hàng:")+"Kho nhận hàng:".Length).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_222">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_ShipTo.Substring(0,str_ShipTo.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_223">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(str_ShipTo," {2,}","|")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_224">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("|"c)(0).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                        <Assign sap:VirtualizedContainerService.HintSize="400,70" sap2010:WorkflowViewState.IdRef="Assign_225">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[CusAgen]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("-"c)(0).trim]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </If.Else>
                                              </If>
                                              <Sequence DisplayName="Get Table" sap:VirtualizedContainerService.HintSize="3056,2528" sap2010:WorkflowViewState.IdRef="Sequence_336">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[str_Text.ToLower.Trim.Contains(&quot;stt&quot;)]" sap:VirtualizedContainerService.HintSize="2994,2406" sap2010:WorkflowViewState.IdRef="If_184">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <If Condition="[Not str_Text.Trim.Contains(&quot;Tổng&quot;)]" DisplayName="If // Kiểm tra table hiện tại là cuối trang hay chưa" sap:VirtualizedContainerService.HintSize="2958,2207" sap2010:WorkflowViewState.IdRef="If_183">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="2122,2038" sap2010:WorkflowViewState.IdRef="Sequence_292">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="2080,70" sap2010:WorkflowViewState.IdRef="Assign_226">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("STT")+"STT".Length + 1).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="2080,70" sap2010:WorkflowViewState.IdRef="Assign_227">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(PO_Table," {2,}","|")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="2080,70" sap2010:WorkflowViewState.IdRef="Assign_228">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="s:String[]">[arr_ListItem]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="s:String[]">[PO_Table.Split(New String() {Environment.NewLine},StringSplitOptions.None)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="2080,70" sap2010:WorkflowViewState.IdRef="Assign_229">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Int32">[i]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="2080,1508" sap2010:WorkflowViewState.IdRef="ForEach`1_19" Values="[arr_ListItem]">
                                                            <ui:ForEach.Body>
                                                              <ActivityAction x:TypeArguments="x:String">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="x:String" Name="line" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="2044,1374" sap2010:WorkflowViewState.IdRef="Sequence_291">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If Condition="[line.ToLower.Contains(&quot;barcode&quot;) or line.Trim = &quot;&quot;]" DisplayName="If bỏ qua header" sap:VirtualizedContainerService.HintSize="2002,1284" sap2010:WorkflowViewState.IdRef="If_154">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Else>
                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1857,1115" sap2010:WorkflowViewState.IdRef="Sequence_290">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="1815,70" sap2010:WorkflowViewState.IdRef="Assign_230">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[line.Split({"|"},StringSplitOptions.None)]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="1815,70" sap2010:WorkflowViewState.IdRef="Assign_231">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[arr_Line.Where(Function(x) Not String.IsNullOrWhiteSpace(x)).ToArray]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1815,32" sap2010:WorkflowViewState.IdRef="CommentOut_20">
                                                                          <ui:CommentOut.Body>
                                                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="400,122" sap2010:WorkflowViewState.IdRef="Sequence_252">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_128">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,470" sap2010:WorkflowViewState.IdRef="Sequence_248">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_232">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_28">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_115">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_434">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_435">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_436">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_437">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_251">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_127">
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_249">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_233">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_250">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </Sequence>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </Sequence>
                                                                          </ui:CommentOut.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:CommentOut>
                                                                        <If Condition="[arr_Line(0).Length &lt; 2]" DisplayName="If kiểm tra form đặc biệt" sap:VirtualizedContainerService.HintSize="1815,661" sap2010:WorkflowViewState.IdRef="If_145">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form thường" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="885,470" sap2010:WorkflowViewState.IdRef="Switch`1_12">
                                                                              <Switch.Default>
                                                                                <Sequence sap:VirtualizedContainerService.HintSize="644.666666666667,1049.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_264">
                                                                                  <Sequence.Variables>
                                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                  </Sequence.Variables>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="602.666666666667,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_240">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="602.666666666667,764" sap2010:WorkflowViewState.IdRef="ForEach`1_16" Values="[arr_Line]">
                                                                                    <ui:ForEach.Body>
                                                                                      <ActivityAction x:TypeArguments="x:String">
                                                                                        <ActivityAction.Argument>
                                                                                          <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                                                        </ActivityAction.Argument>
                                                                                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="566,637.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_260">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="524,545.333333333333" sap2010:WorkflowViewState.IdRef="IfElseIf_1">
                                                                                            <ui:IfElseIf.ConditionBlocks>
                                                                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                                <ui:IfElseIfBlock BlockType="If" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;) and arr_Line.Count &lt; 4]">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_241">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="200,68" sap2010:WorkflowViewState.IdRef="Sequence_259">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_132">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <If.Then>
                                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_242">
                                                                                                            <Assign.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                            </Assign.To>
                                                                                                            <Assign.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                                            </Assign.Value>
                                                                                                          </Assign>
                                                                                                        </If.Then>
                                                                                                        <If.Else>
                                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_243">
                                                                                                            <Assign.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                            </Assign.To>
                                                                                                            <Assign.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                                            </Assign.Value>
                                                                                                          </Assign>
                                                                                                        </If.Else>
                                                                                                      </If>
                                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_118">
                                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_446">
                                                                                                              <ui:AssignOperation.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                              </ui:AssignOperation.To>
                                                                                                              <ui:AssignOperation.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                                              </ui:AssignOperation.Value>
                                                                                                            </ui:AssignOperation>
                                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_447">
                                                                                                              <ui:AssignOperation.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                              </ui:AssignOperation.To>
                                                                                                              <ui:AssignOperation.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                              </ui:AssignOperation.Value>
                                                                                                            </ui:AssignOperation>
                                                                                                          </scg:List>
                                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                      </ui:MultipleAssign>
                                                                                                      <ui:Break sap:VirtualizedContainerService.HintSize="430.666666666667,22" sap2010:WorkflowViewState.IdRef="Break_4" />
                                                                                                    </Sequence>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                                <ui:IfElseIfBlock BlockType="Else">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_244">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                              </sc:BindingList>
                                                                                            </ui:IfElseIf.ConditionBlocks>
                                                                                          </ui:IfElseIf>
                                                                                        </Sequence>
                                                                                      </ActivityAction>
                                                                                    </ui:ForEach.Body>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </ui:ForEach>
                                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="1348.66666666667,931.333333333333" sap2010:WorkflowViewState.IdRef="If_136">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1312,739.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_263">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,647.333333333333" sap2010:WorkflowViewState.IdRef="If_135">
                                                                                          <If.Then>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_261">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_133">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_245">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_246">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_119">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_448">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_449">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_262">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_134">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_247">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_248">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_120">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_450">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_451">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </Sequence>
                                                                              </Switch.Default>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_129">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_253">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_234">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_235">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_29">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_116">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_438">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_439">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_440">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_441">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_254">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_236">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_237">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                              <If x:Key="1" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,228" sap2010:WorkflowViewState.IdRef="If_131">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_255">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_238">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen,dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_30">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_117">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_442">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_443">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_444">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_445">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_258">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_130">
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_256">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_239">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_257">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </Sequence>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </Switch>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form đặc biệt" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="885,492" sap2010:WorkflowViewState.IdRef="Switch`1_13">
                                                                              <Switch.Default>
                                                                                <Sequence sap:VirtualizedContainerService.HintSize="304,246.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_276">
                                                                                  <Sequence.Variables>
                                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                  </Sequence.Variables>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_259">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="262,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_218">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1312,734" sap2010:WorkflowViewState.IdRef="Sequence_388">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,642" sap2010:WorkflowViewState.IdRef="If_217">
                                                                                          <If.Then>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,482.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_386">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,220.666666666667" sap2010:WorkflowViewState.IdRef="If_215">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_416">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_417">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_164">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_572">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_573">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,482.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_387">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,220.666666666667" sap2010:WorkflowViewState.IdRef="If_216">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_418">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_419">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_165">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_574">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_575">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </Sequence>
                                                                              </Switch.Default>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,708" sap2010:WorkflowViewState.IdRef="If_138">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_265">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_249">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_250">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_31">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_121">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_452">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_453">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_454">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_455">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_266">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="484,70" sap2010:WorkflowViewState.IdRef="Assign_251">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <If Condition="[arr_Line(1).Contains(&quot;-&quot;)]" sap:VirtualizedContainerService.HintSize="484,240" sap2010:WorkflowViewState.IdRef="If_137">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Else>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_252">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:IfElseIf x:Key="1" DisplayName="Else If" sap:VirtualizedContainerService.HintSize="451,856" sap2010:WorkflowViewState.IdRef="IfElseIf_2">
                                                                                <ui:IfElseIf.ConditionBlocks>
                                                                                  <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                    <ui:IfElseIfBlock BlockType="If" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="400,470" sap2010:WorkflowViewState.IdRef="Sequence_267">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_253">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_32">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:AddDataRow>
                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_122">
                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_456">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_457">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_458">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_459">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                              </scg:List>
                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:MultipleAssign>
                                                                                        </Sequence>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                    <ui:IfElseIfBlock BlockType="ElseIf" Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_254">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                    <ui:IfElseIfBlock BlockType="Else">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_268">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </Sequence>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                  </sc:BindingList>
                                                                                </ui:IfElseIf.ConditionBlocks>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:IfElseIf>
                                                                              <If x:Key="3" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_139">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_269">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_255">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_256">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_33">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_123">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_460">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_461">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_462">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_463">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_270">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_257">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_258">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </Switch>
                                                                          </If.Else>
                                                                        </If>
                                                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1815,32" sap2010:WorkflowViewState.IdRef="CommentOut_21">
                                                                          <ui:CommentOut.Body>
                                                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="400,122" sap2010:WorkflowViewState.IdRef="Sequence_289">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Switch x:TypeArguments="x:Int32" DisplayName="Switch" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="885,470" sap2010:WorkflowViewState.IdRef="Switch`1_14">
                                                                                <Switch.Default>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="644.666666666667,1049.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_288">
                                                                                    <Sequence.Variables>
                                                                                      <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                    </Sequence.Variables>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="602.666666666667,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_274">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="602.666666666667,764" sap2010:WorkflowViewState.IdRef="ForEach`1_18" Values="[arr_Line]">
                                                                                      <ui:ForEach.Body>
                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                          <ActivityAction.Argument>
                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                                                          </ActivityAction.Argument>
                                                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="566,637.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_284">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="524,545.333333333333" sap2010:WorkflowViewState.IdRef="IfElseIf_4">
                                                                                              <ui:IfElseIf.ConditionBlocks>
                                                                                                <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                                  <ui:IfElseIfBlock BlockType="If" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;) and arr_Line.Count &lt; 4]">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_275">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                  <ui:IfElseIfBlock BlockType="ElseIf" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="200,68" sap2010:WorkflowViewState.IdRef="Sequence_283">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_149">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <If.Then>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_276">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Then>
                                                                                                          <If.Else>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_277">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Else>
                                                                                                        </If>
                                                                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_129">
                                                                                                          <ui:MultipleAssign.AssignOperations>
                                                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_478">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_479">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                            </scg:List>
                                                                                                          </ui:MultipleAssign.AssignOperations>
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                        </ui:MultipleAssign>
                                                                                                        <ui:Break sap:VirtualizedContainerService.HintSize="430.666666666667,22" sap2010:WorkflowViewState.IdRef="Break_6" />
                                                                                                      </Sequence>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                  <ui:IfElseIfBlock BlockType="Else">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_278">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                </sc:BindingList>
                                                                                              </ui:IfElseIf.ConditionBlocks>
                                                                                            </ui:IfElseIf>
                                                                                          </Sequence>
                                                                                        </ActivityAction>
                                                                                      </ui:ForEach.Body>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:ForEach>
                                                                                    <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="1348.66666666667,1064.66666666667" sap2010:WorkflowViewState.IdRef="If_153">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="1312,872.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_287">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1270,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[arr_Line(1).ToString]" />
                                                                                          <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,647.333333333333" sap2010:WorkflowViewState.IdRef="If_152">
                                                                                            <If.Then>
                                                                                              <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_285">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_150">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_279">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_280">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_130">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_480">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_481">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:MultipleAssign>
                                                                                              </Sequence>
                                                                                            </If.Then>
                                                                                            <If.Else>
                                                                                              <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_286">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_151">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_281">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_282">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_131">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_482">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_483">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:MultipleAssign>
                                                                                              </Sequence>
                                                                                            </If.Else>
                                                                                          </If>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </Switch.Default>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_146">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_277">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_268">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_269">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen,dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_34">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:AddDataRow>
                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_127">
                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_470">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_471">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_472">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_473">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                          </scg:List>
                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:MultipleAssign>
                                                                                    </Sequence>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_278">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_270">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_271">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <If x:Key="1" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,598" sap2010:WorkflowViewState.IdRef="If_148">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,470" sap2010:WorkflowViewState.IdRef="Sequence_279">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_272">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen,dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_35">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:AddDataRow>
                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_128">
                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_474">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_475">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_476">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_477">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                          </scg:List>
                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:MultipleAssign>
                                                                                    </Sequence>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_282">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_147">
                                                                                        <If.Then>
                                                                                          <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_280">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_273">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </Sequence>
                                                                                        </If.Then>
                                                                                        <If.Else>
                                                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_281">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Sequence>
                                                                                        </If.Else>
                                                                                      </If>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                              </Switch>
                                                                            </Sequence>
                                                                          </ui:CommentOut.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:CommentOut>
                                                                      </Sequence>
                                                                    </If.Else>
                                                                  </If>
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </ui:ForEach.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:ForEach>
                                                        </Sequence>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="791,1424" sap2010:WorkflowViewState.IdRef="Sequence_334">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="749,70" sap2010:WorkflowViewState.IdRef="Assign_283">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("STT"),str_Text.IndexOf("Tổng")-str_Text.IndexOf("STT")).Trim]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="749,70" sap2010:WorkflowViewState.IdRef="Assign_284">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(PO_Table," {2,}","|")]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <Assign sap:VirtualizedContainerService.HintSize="749,70" sap2010:WorkflowViewState.IdRef="Assign_285">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="s:String[]">[arr_ListItem]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="s:String[]">[PO_Table.Split(New String() {Environment.NewLine},StringSplitOptions.None)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="749,1004" sap2010:WorkflowViewState.IdRef="ForEach`1_23" Values="[arr_ListItem]">
                                                            <ui:ForEach.Body>
                                                              <ActivityAction x:TypeArguments="x:String">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="x:String" Name="line" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="713,870" sap2010:WorkflowViewState.IdRef="Sequence_333">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If Condition="[line.ToLower.Contains(&quot;barcode&quot;) or line.Trim = &quot;&quot;]" sap:VirtualizedContainerService.HintSize="671,780" sap2010:WorkflowViewState.IdRef="If_182">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Else>
                                                                      <Sequence sap:VirtualizedContainerService.HintSize="526,611" sap2010:WorkflowViewState.IdRef="Sequence_332">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="484,70" sap2010:WorkflowViewState.IdRef="Assign_286">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[line.Split({"|"},StringSplitOptions.None)]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="484,70" sap2010:WorkflowViewState.IdRef="Assign_287">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[arr_Line.Where(Function(x) Not String.IsNullOrWhiteSpace(x)).ToArray]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <If Condition="[arr_Line(0).Length &lt; 2]" DisplayName="If kiểm tra form đặc biệt" sap:VirtualizedContainerService.HintSize="484,229" sap2010:WorkflowViewState.IdRef="If_171">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form thường" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="885,470" sap2010:WorkflowViewState.IdRef="Switch`1_15">
                                                                              <Switch.Default>
                                                                                <Sequence sap:VirtualizedContainerService.HintSize="644.666666666667,1049.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_304">
                                                                                  <Sequence.Variables>
                                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                  </Sequence.Variables>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="602.666666666667,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_294">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="602.666666666667,764" sap2010:WorkflowViewState.IdRef="ForEach`1_20" Values="[arr_Line]">
                                                                                    <ui:ForEach.Body>
                                                                                      <ActivityAction x:TypeArguments="x:String">
                                                                                        <ActivityAction.Argument>
                                                                                          <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                                                        </ActivityAction.Argument>
                                                                                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="566,637.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_300">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="524,545.333333333333" sap2010:WorkflowViewState.IdRef="IfElseIf_5">
                                                                                            <ui:IfElseIf.ConditionBlocks>
                                                                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                                <ui:IfElseIfBlock BlockType="If" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;) and arr_Line.Count &lt; 4]">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_295">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="200,68" sap2010:WorkflowViewState.IdRef="Sequence_299">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_158">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <If.Then>
                                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_296">
                                                                                                            <Assign.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                            </Assign.To>
                                                                                                            <Assign.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                                            </Assign.Value>
                                                                                                          </Assign>
                                                                                                        </If.Then>
                                                                                                        <If.Else>
                                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_297">
                                                                                                            <Assign.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                            </Assign.To>
                                                                                                            <Assign.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                                            </Assign.Value>
                                                                                                          </Assign>
                                                                                                        </If.Else>
                                                                                                      </If>
                                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_134">
                                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_492">
                                                                                                              <ui:AssignOperation.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                              </ui:AssignOperation.To>
                                                                                                              <ui:AssignOperation.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                                              </ui:AssignOperation.Value>
                                                                                                            </ui:AssignOperation>
                                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_493">
                                                                                                              <ui:AssignOperation.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                              </ui:AssignOperation.To>
                                                                                                              <ui:AssignOperation.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                              </ui:AssignOperation.Value>
                                                                                                            </ui:AssignOperation>
                                                                                                          </scg:List>
                                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                      </ui:MultipleAssign>
                                                                                                      <ui:Break sap:VirtualizedContainerService.HintSize="430.666666666667,22" sap2010:WorkflowViewState.IdRef="Break_7" />
                                                                                                    </Sequence>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                                <ui:IfElseIfBlock BlockType="Else">
                                                                                                  <ui:IfElseIfBlock.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_298">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </ui:IfElseIfBlock.Then>
                                                                                                </ui:IfElseIfBlock>
                                                                                              </sc:BindingList>
                                                                                            </ui:IfElseIf.ConditionBlocks>
                                                                                          </ui:IfElseIf>
                                                                                        </Sequence>
                                                                                      </ActivityAction>
                                                                                    </ui:ForEach.Body>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </ui:ForEach>
                                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="1348.66666666667,932" sap2010:WorkflowViewState.IdRef="If_162">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1312,740" sap2010:WorkflowViewState.IdRef="Sequence_303">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,648" sap2010:WorkflowViewState.IdRef="If_161">
                                                                                          <If.Then>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,486" sap2010:WorkflowViewState.IdRef="Sequence_301">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,224" sap2010:WorkflowViewState.IdRef="If_159">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_299">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_300">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_135">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_494">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_495">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,486" sap2010:WorkflowViewState.IdRef="Sequence_302">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,224" sap2010:WorkflowViewState.IdRef="If_160">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_301">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_302">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_136">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_496">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_497">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </Sequence>
                                                                              </Switch.Default>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_155">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_293">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_288">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_289">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_36">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_132">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_484">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_485">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_486">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_487">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_294">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_290">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_291">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                              <If x:Key="1" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,598" sap2010:WorkflowViewState.IdRef="If_157">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,470" sap2010:WorkflowViewState.IdRef="Sequence_295">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_292">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_37">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_133">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_488">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_489">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_490">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_491">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_298">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_156">
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_296">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_293">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_297">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </Sequence>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </Switch>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form đặc biệt" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="200,32" sap2010:WorkflowViewState.IdRef="Switch`1_16">
                                                                              <Switch.Default>
                                                                                <Sequence sap:VirtualizedContainerService.HintSize="304,246.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_316">
                                                                                  <Sequence.Variables>
                                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                  </Sequence.Variables>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_313">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="262,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_214">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1312,734" sap2010:WorkflowViewState.IdRef="Sequence_385">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,642" sap2010:WorkflowViewState.IdRef="If_213">
                                                                                          <If.Then>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,482.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_383">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,220.666666666667" sap2010:WorkflowViewState.IdRef="If_211">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_412">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_413">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_162">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_568">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_569">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,482.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_384">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,220.666666666667" sap2010:WorkflowViewState.IdRef="If_212">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_414">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Then>
                                                                                                <If.Else>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_415">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </If.Else>
                                                                                              </If>
                                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_163">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_570">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_571">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </Sequence>
                                                                              </Switch.Default>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_164">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_305">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_303">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_304">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_38">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_137">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_498">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_499">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_500">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_501">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_306">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="484,70" sap2010:WorkflowViewState.IdRef="Assign_305">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <If Condition="[arr_Line(1).Contains(&quot;-&quot;)]" sap:VirtualizedContainerService.HintSize="484,240" sap2010:WorkflowViewState.IdRef="If_163">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Else>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_306">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:IfElseIf x:Key="1" DisplayName="Else If" sap:VirtualizedContainerService.HintSize="451,796" sap2010:WorkflowViewState.IdRef="IfElseIf_6">
                                                                                <ui:IfElseIf.ConditionBlocks>
                                                                                  <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                    <ui:IfElseIfBlock BlockType="If" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="400,470" sap2010:WorkflowViewState.IdRef="Sequence_307">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_307">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_39">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:AddDataRow>
                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_138">
                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_502">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_503">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_504">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_505">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                                    </InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                              </scg:List>
                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:MultipleAssign>
                                                                                        </Sequence>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                    <ui:IfElseIfBlock BlockType="ElseIf" Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,70" sap2010:WorkflowViewState.IdRef="Assign_308">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                    <ui:IfElseIfBlock BlockType="Else">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_308" />
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                  </sc:BindingList>
                                                                                </ui:IfElseIf.ConditionBlocks>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:IfElseIf>
                                                                              <If x:Key="3" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,228" sap2010:WorkflowViewState.IdRef="If_165">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_309">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_309">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_310">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_40">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:AddDataRow>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_139">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_506">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_507">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_508">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_509">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:MultipleAssign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_310">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_311">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_312">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </Switch>
                                                                          </If.Else>
                                                                        </If>
                                                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="484,32" sap2010:WorkflowViewState.IdRef="CommentOut_23">
                                                                          <ui:CommentOut.Body>
                                                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="400,122" sap2010:WorkflowViewState.IdRef="Sequence_331">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Switch x:TypeArguments="x:Int32" DisplayName="Switch" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="885,470" sap2010:WorkflowViewState.IdRef="Switch`1_17">
                                                                                <Switch.Default>
                                                                                  <Sequence sap:VirtualizedContainerService.HintSize="476,648.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_330">
                                                                                    <Sequence.Variables>
                                                                                      <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                                    </Sequence.Variables>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="434,62" sap2010:WorkflowViewState.IdRef="Assign_328">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="434,362" sap2010:WorkflowViewState.IdRef="ForEach`1_22" Values="[arr_Line]">
                                                                                      <ui:ForEach.Body>
                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                          <ActivityAction.Argument>
                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                                                          </ActivityAction.Argument>
                                                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,237.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_326">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="200,52.6666666666667" sap2010:WorkflowViewState.IdRef="IfElseIf_8">
                                                                                              <ui:IfElseIf.ConditionBlocks>
                                                                                                <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                                  <ui:IfElseIfBlock BlockType="If" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;) and arr_Line.Count &lt; 4]">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_329">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                  <ui:IfElseIfBlock BlockType="ElseIf" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_323">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_175">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <If.Then>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_330">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Then>
                                                                                                          <If.Else>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_331">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Else>
                                                                                                        </If>
                                                                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_145">
                                                                                                          <ui:MultipleAssign.AssignOperations>
                                                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_524">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_525">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                            </scg:List>
                                                                                                          </ui:MultipleAssign.AssignOperations>
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                        </ui:MultipleAssign>
                                                                                                        <ui:Break sap:VirtualizedContainerService.HintSize="430.666666666667,22" sap2010:WorkflowViewState.IdRef="Break_9" />
                                                                                                      </Sequence>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                  <ui:IfElseIfBlock BlockType="Else">
                                                                                                    <ui:IfElseIfBlock.Then>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_332">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </ui:IfElseIfBlock.Then>
                                                                                                  </ui:IfElseIfBlock>
                                                                                                </sc:BindingList>
                                                                                              </ui:IfElseIf.ConditionBlocks>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:IfElseIf>
                                                                                            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,52.6666666666667" sap2010:WorkflowViewState.IdRef="CommentOut_22">
                                                                                              <ui:CommentOut.Body>
                                                                                                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,144.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_325">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]" DisplayName="If // Nếu SP cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="200,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_177">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <If.Then>
                                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="612,546.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_324">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,222.666666666667" sap2010:WorkflowViewState.IdRef="If_176">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <If.Then>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_333">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Then>
                                                                                                          <If.Else>
                                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_334">
                                                                                                              <Assign.To>
                                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                              </Assign.To>
                                                                                                              <Assign.Value>
                                                                                                                <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                                              </Assign.Value>
                                                                                                            </Assign>
                                                                                                          </If.Else>
                                                                                                        </If>
                                                                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_146">
                                                                                                          <ui:MultipleAssign.AssignOperations>
                                                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_526">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_527">
                                                                                                                <ui:AssignOperation.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                                </ui:AssignOperation.To>
                                                                                                                <ui:AssignOperation.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                                </ui:AssignOperation.Value>
                                                                                                              </ui:AssignOperation>
                                                                                                            </scg:List>
                                                                                                          </ui:MultipleAssign.AssignOperations>
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                        </ui:MultipleAssign>
                                                                                                        <ui:Break sap:VirtualizedContainerService.HintSize="570,22" sap2010:WorkflowViewState.IdRef="Break_10" />
                                                                                                      </Sequence>
                                                                                                    </If.Then>
                                                                                                    <If.Else>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_335">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </If.Else>
                                                                                                  </If>
                                                                                                </Sequence>
                                                                                              </ui:CommentOut.Body>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:CommentOut>
                                                                                          </Sequence>
                                                                                        </ActivityAction>
                                                                                      </ui:ForEach.Body>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                    </ui:ForEach>
                                                                                    <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="434,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_181">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Then>
                                                                                        <Sequence sap:VirtualizedContainerService.HintSize="1172.66666666667,744" sap2010:WorkflowViewState.IdRef="Sequence_329">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1130.66666666667,652" sap2010:WorkflowViewState.IdRef="If_180">
                                                                                            <If.Then>
                                                                                              <Sequence sap:VirtualizedContainerService.HintSize="472.666666666667,314.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_327">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_178">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_336">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_337">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_147">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_528">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_529">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:MultipleAssign>
                                                                                              </Sequence>
                                                                                            </If.Then>
                                                                                            <If.Else>
                                                                                              <Sequence sap:VirtualizedContainerService.HintSize="612,488" sap2010:WorkflowViewState.IdRef="Sequence_328">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,226" sap2010:WorkflowViewState.IdRef="If_179">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_338">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_339">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_148">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_530">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_531">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:MultipleAssign>
                                                                                              </Sequence>
                                                                                            </If.Else>
                                                                                          </If>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                </Switch.Default>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,250" sap2010:WorkflowViewState.IdRef="If_172">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,580" sap2010:WorkflowViewState.IdRef="Sequence_317">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_322">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_323">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_41">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:AddDataRow>
                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_143">
                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_516">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_517">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_518">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_519">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                          </scg:List>
                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:MultipleAssign>
                                                                                    </Sequence>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_318">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_324">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_325">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <If x:Key="1" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="845,598" sap2010:WorkflowViewState.IdRef="If_174">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_319">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_326">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_42">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:AddDataRow>
                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_144">
                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_520">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_521">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_522">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_523">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">
                                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                                </InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                          </scg:List>
                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:MultipleAssign>
                                                                                    </Sequence>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_322">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_173">
                                                                                        <If.Then>
                                                                                          <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_320">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_327">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </Sequence>
                                                                                        </If.Then>
                                                                                        <If.Else>
                                                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_321">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Sequence>
                                                                                        </If.Else>
                                                                                      </If>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                              </Switch>
                                                                            </Sequence>
                                                                          </ui:CommentOut.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:CommentOut>
                                                                      </Sequence>
                                                                    </If.Else>
                                                                  </If>
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </ui:ForEach.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:ForEach>
                                                        </Sequence>
                                                      </If.Else>
                                                    </If>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_335">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <Assign sap:VirtualizedContainerService.HintSize="2668,70" sap2010:WorkflowViewState.IdRef="Assign_340">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[int_PageDefault]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[int_PageDefault + 1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </ui:InterruptibleDoWhile.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InterruptibleDoWhile>
                                      </Sequence>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID0">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">200,463.666666666667</av:Point>
                                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">300,517.666666666667 300,566.333333333334</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[in_Config(&quot;Folder_Path&quot;).ToString+&quot;\&quot;+Now.ToString(&quot;yyyyMM&quot;)+&quot;\BHX\Input\Archive\&quot;+FileName]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="MoveFile_3" Path="[file]" />
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID4">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">200,566.333333333334</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If Condition="[out_PONumber = &quot;&quot;]" DisplayName="Add PONumber" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_205">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_402">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[out_PONumber]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[PONumber]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </If.Then>
                                                <If.Else>
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_403">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[out_PONumber]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[out_PONumber+","+PONumber]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </If.Else>
                                              </If>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowDecision.True>
                                  <FlowDecision.False>
                                    <FlowStep x:Name="__ReferenceID3">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">393,298.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,83</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">493,381.5 493,490.666666666667 400,490.666666666667</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Sequence DisplayName="Read all page" sap:VirtualizedContainerService.HintSize="807,4622" sap2010:WorkflowViewState.IdRef="Sequence_374">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="745,53" sap2010:WorkflowViewState.IdRef="WriteLine_5" Text="[&quot;One page: &quot;+FileName]" />
                                        <ui:ReadPDFText DisplayName="Read PDF Text" FileName="[file]" sap:VirtualizedContainerService.HintSize="745,53" sap2010:WorkflowViewState.IdRef="ReadPDFText_5" PreserveFormatting="True" Range="all" Text="[str_Text]" />
                                        <If Condition="[str_Text.ToLower.Contains(&quot;kho ncc giao&quot;)]" DisplayName="If kiểm tra phần ngoài bảng" sap:VirtualizedContainerService.HintSize="745,2009" sap2010:WorkflowViewState.IdRef="If_185">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence DisplayName="Lấy dữ liệu ngoài bảng - online" sap:VirtualizedContainerService.HintSize="538,1746" sap2010:WorkflowViewState.IdRef="Sequence_342">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="PONumber" sap:VirtualizedContainerService.HintSize="496,83" sap2010:WorkflowViewState.IdRef="Sequence_339">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_341">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Mã đơn hàng:")+"Mã đơn hàng:".Length + 1).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_342">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[PONumber.Substring(0,PONumber.IndexOf(Environment.NewLine)).Trim.Split(" "c)(0)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="Date" sap:VirtualizedContainerService.HintSize="496,563" sap2010:WorkflowViewState.IdRef="Sequence_340">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_343">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Ngày đặt hàng:")+"Ngày đặt hàng:".Length + 1).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_344">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Date.Substring(0,str_Date.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_345">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="s:DateTime">[DateTime]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="s:DateTime">[DateTime.ParseExact(str_Date.Split(" "c)(0),"dd/MM/yyyy",System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_346">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[DateTime.ToString("yyyyMMdd")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="ShipTo" sap:VirtualizedContainerService.HintSize="496,809" sap2010:WorkflowViewState.IdRef="Sequence_341">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_347">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Kho NCC giao")+"Kho NCC giao".Length).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_348">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_ShipTo.Substring(0,str_ShipTo.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_349">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(str_ShipTo," {2,}","|")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_350">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("|"c)(0).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_424">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[s]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[Regex.Replace(str_Text.Trim,"\s",String.Empty).ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_425">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[dateTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">["Han_"+System.Text.RegularExpressions.Regex.Match(s, "(?&lt;=NgàyNCCgiaohàng:)\d{2}.\d{2}.\d{4}.\d.........").Value.ToString.Substring(11,5)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Assign sap:VirtualizedContainerService.HintSize="496,83" sap2010:WorkflowViewState.IdRef="Assign_351">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[CusAgen]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("-"c)(0).trim]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </If.Then>
                                          <If.Else>
                                            <Sequence DisplayName="Lấy dữ liệu ngoài bảng - kho offline" sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_346">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="PONumber" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_343">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_352">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Mã đơn hàng:")+"Mã đơn hàng:".Length + 1).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_353">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[PONumber.Substring(0,PONumber.IndexOf(Environment.NewLine)).Trim.Split(" "c)(0)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="Date" sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_344">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_354">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Ngày đặt hàng:")+"Ngày đặt hàng:".Length + 1).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_355">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Date.Substring(0,str_Date.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_356">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="s:DateTime">[DateTime]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="s:DateTime">[DateTime.ParseExact(str_Date.Split(" "c)(0),"dd/MM/yyyy",System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_357">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_Date]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[DateTime.ToString("yyyyMMdd")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="ShipTo" sap:VirtualizedContainerService.HintSize="400,742" sap2010:WorkflowViewState.IdRef="Sequence_345">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_358">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("Kho nhận hàng:")+"Kho nhận hàng:".Length).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_359">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_ShipTo.Substring(0,str_ShipTo.IndexOf(Environment.NewLine)).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_360">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(str_ShipTo," {2,}","|")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_361">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[str_ShipTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("|"c)(0).Trim]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_426">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[s]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[Regex.Replace(str_Text.Trim,"\s",String.Empty).ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="338,70" sap2010:WorkflowViewState.IdRef="Assign_427">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[dateTo]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">["Han_"+System.Text.RegularExpressions.Regex.Match(s, "(?&lt;=NgàyNCCgiaohàng:)\d{2}.\d{2}.\d{4}.\d.........").Value.ToString.Substring(11,5)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Assign sap:VirtualizedContainerService.HintSize="400,70" sap2010:WorkflowViewState.IdRef="Assign_362">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[CusAgen]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[str_ShipTo.Split("-"c)(0).trim]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </If.Else>
                                        </If>
                                        <Sequence DisplayName="Get table" sap:VirtualizedContainerService.HintSize="745,2276" sap2010:WorkflowViewState.IdRef="Sequence_373">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="683,83" sap2010:WorkflowViewState.IdRef="Assign_363">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[str_Text.Substring(str_Text.IndexOf("STT"),str_Text.IndexOf("Tổng")-str_Text.IndexOf("STT")).Trim]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign sap:VirtualizedContainerService.HintSize="683,83" sap2010:WorkflowViewState.IdRef="Assign_364">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[PO_Table]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(PO_Table," {2,}","|")]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign sap:VirtualizedContainerService.HintSize="683,83" sap2010:WorkflowViewState.IdRef="Assign_365">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="s:String[]">[arr_ListItem]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="s:String[]">[PO_Table.Split(New String() {Environment.NewLine},StringSplitOptions.None)]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="683,1796" sap2010:WorkflowViewState.IdRef="ForEach`1_26" Values="[arr_ListItem]">
                                            <ui:ForEach.Body>
                                              <ActivityAction x:TypeArguments="x:String">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="x:String" Name="line" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="649,1608" sap2010:WorkflowViewState.IdRef="Sequence_372">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[line.ToLower.Contains(&quot;barcode&quot;) or line.Trim = &quot;&quot;]" sap:VirtualizedContainerService.HintSize="607,1520" sap2010:WorkflowViewState.IdRef="If_203">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Else>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="573,1257" sap2010:WorkflowViewState.IdRef="Sequence_371">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="531,83" sap2010:WorkflowViewState.IdRef="Assign_366">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="s:String[]">[line.Split({"|"},StringSplitOptions.None)]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="531,83" sap2010:WorkflowViewState.IdRef="Assign_367">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="s:String[]">[arr_Line]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="s:String[]">[arr_Line.Where(Function(x) Not String.IsNullOrWhiteSpace(x)).ToArray]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <If Condition="[arr_Line(0).Length &lt; 2]" DisplayName="If kiểm tra form đặc biệt" sap:VirtualizedContainerService.HintSize="531,923" sap2010:WorkflowViewState.IdRef="If_202">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form thường" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="497,553" sap2010:WorkflowViewState.IdRef="Switch`1_18">
                                                              <Switch.Default>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="644.666666666667,1049.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_358">
                                                                  <Sequence.Variables>
                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                  </Sequence.Variables>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="602.666666666667,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_374">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="602.666666666667,764" sap2010:WorkflowViewState.IdRef="ForEach`1_24" Values="[arr_Line]">
                                                                    <ui:ForEach.Body>
                                                                      <ActivityAction x:TypeArguments="x:String">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="566,637.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_354">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="524,545.333333333333" sap2010:WorkflowViewState.IdRef="IfElseIf_9">
                                                                            <ui:IfElseIf.ConditionBlocks>
                                                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                <ui:IfElseIfBlock BlockType="If" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;) and arr_Line.Count &lt; 4]">
                                                                                  <ui:IfElseIfBlock.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_375">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </ui:IfElseIfBlock.Then>
                                                                                </ui:IfElseIfBlock>
                                                                                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[item.Length = 13 and item.IsNumeric and not item.Contains(&quot;,&quot;)]">
                                                                                  <ui:IfElseIfBlock.Then>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="200,68" sap2010:WorkflowViewState.IdRef="Sequence_353">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="430.666666666667,52.6666666666667" sap2010:WorkflowViewState.IdRef="If_189">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If.Then>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_376">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+1)]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </If.Then>
                                                                                        <If.Else>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_377">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(int_Linecount+1)]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </If.Else>
                                                                                      </If>
                                                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="430.666666666667,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_151">
                                                                                        <ui:MultipleAssign.AssignOperations>
                                                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_540">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[arr_Line(int_Linecount+3)]</InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_541">
                                                                                              <ui:AssignOperation.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                              </ui:AssignOperation.To>
                                                                                              <ui:AssignOperation.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(int_Linecount+5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                              </ui:AssignOperation.Value>
                                                                                            </ui:AssignOperation>
                                                                                          </scg:List>
                                                                                        </ui:MultipleAssign.AssignOperations>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:MultipleAssign>
                                                                                      <ui:Break sap:VirtualizedContainerService.HintSize="430.666666666667,22" sap2010:WorkflowViewState.IdRef="Break_11" />
                                                                                    </Sequence>
                                                                                  </ui:IfElseIfBlock.Then>
                                                                                </ui:IfElseIfBlock>
                                                                                <ui:IfElseIfBlock BlockType="Else">
                                                                                  <ui:IfElseIfBlock.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_378">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Int32">[int_Linecount + 1]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </ui:IfElseIfBlock.Then>
                                                                                </ui:IfElseIfBlock>
                                                                              </sc:BindingList>
                                                                            </ui:IfElseIf.ConditionBlocks>
                                                                          </ui:IfElseIf>
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ForEach.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ForEach>
                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="1348.66666666667,931.333333333333" sap2010:WorkflowViewState.IdRef="If_193">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Then>
                                                                      <Sequence sap:VirtualizedContainerService.HintSize="1312,739.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_357">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="1270,647.333333333333" sap2010:WorkflowViewState.IdRef="If_192">
                                                                          <If.Then>
                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_355">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_190">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_379">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_380">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_152">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_542">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_543">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:MultipleAssign>
                                                                            </Sequence>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Sequence sap:VirtualizedContainerService.HintSize="612,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_356">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="570,223.333333333333" sap2010:WorkflowViewState.IdRef="If_191">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_381">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_382">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="570,130" sap2010:WorkflowViewState.IdRef="MultipleAssign_153">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_544">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_545">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:MultipleAssign>
                                                                            </Sequence>
                                                                          </If.Else>
                                                                        </If>
                                                                      </Sequence>
                                                                    </If.Then>
                                                                  </If>
                                                                </Sequence>
                                                              </Switch.Default>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="334,343" sap2010:WorkflowViewState.IdRef="If_186">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_347">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_368">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_369">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_43">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:AddDataRow>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_149">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_532">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_533">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_534">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_535">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:MultipleAssign>
                                                                  </Sequence>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_348">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_370">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_371">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </Sequence>
                                                                </If.Else>
                                                              </If>
                                                              <If x:Key="1" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="334,183" sap2010:WorkflowViewState.IdRef="If_188">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_349">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_372">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_44">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:AddDataRow>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_150">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_536">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_537">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_538">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_539">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:MultipleAssign>
                                                                  </Sequence>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_352">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]" sap:VirtualizedContainerService.HintSize="484,345.333333333333" sap2010:WorkflowViewState.IdRef="If_187">
                                                                      <If.Then>
                                                                        <Sequence sap:VirtualizedContainerService.HintSize="304,154" sap2010:WorkflowViewState.IdRef="Sequence_350">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_373">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                        </Sequence>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_351">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </Sequence>
                                                                      </If.Else>
                                                                    </If>
                                                                  </Sequence>
                                                                </If.Else>
                                                              </If>
                                                            </Switch>
                                                          </If.Then>
                                                          <If.Else>
                                                            <Switch x:TypeArguments="x:Int32" DisplayName="Switch - Form đặc biệt" Expression="[arr_Line.Count]" sap:VirtualizedContainerService.HintSize="497,187" sap2010:WorkflowViewState.IdRef="Switch`1_19">
                                                              <Switch.Default>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="496,286" sap2010:WorkflowViewState.IdRef="Sequence_370">
                                                                  <Sequence.Variables>
                                                                    <Variable x:TypeArguments="x:Int32" Name="int_Linecount" />
                                                                  </Sequence.Variables>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_393">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">[int_Linecount]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <If Condition="[Dongia = &quot;&quot;]" DisplayName="If // Nếu SP không nằm cùng hàng ngang với barcode" sap:VirtualizedContainerService.HintSize="434,53" sap2010:WorkflowViewState.IdRef="If_210">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Then>
                                                                      <Sequence sap:VirtualizedContainerService.HintSize="597,976" sap2010:WorkflowViewState.IdRef="Sequence_382">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <If Condition="[arr_Line(1).Trim.Length = 1]" sap:VirtualizedContainerService.HintSize="555,888" sap2010:WorkflowViewState.IdRef="If_209">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Sequence sap:VirtualizedContainerService.HintSize="521,625" sap2010:WorkflowViewState.IdRef="Sequence_380">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="479,349" sap2010:WorkflowViewState.IdRef="If_207">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_408">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(2)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_409">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(2)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,148" sap2010:WorkflowViewState.IdRef="MultipleAssign_160">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_564">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(4)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_565">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(6).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:MultipleAssign>
                                                                            </Sequence>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_381">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[TenSP = &quot;&quot;]" DisplayName="If get tenSP" sap:VirtualizedContainerService.HintSize="479,349" sap2010:WorkflowViewState.IdRef="If_208">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_410">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[arr_Line(1)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_411">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[TenSP+" "+arr_Line(1)]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Else>
                                                                              </If>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,148" sap2010:WorkflowViewState.IdRef="MultipleAssign_161">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_566">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(3)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_567">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[Math.Round(CINT(arr_Line(5).Trim)).ToString.Replace(",","")]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:MultipleAssign>
                                                                            </Sequence>
                                                                          </If.Else>
                                                                        </If>
                                                                      </Sequence>
                                                                    </If.Then>
                                                                  </If>
                                                                </Sequence>
                                                              </Switch.Default>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If x:Key="2" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="334,343" sap2010:WorkflowViewState.IdRef="If_195">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_359">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="479,83" sap2010:WorkflowViewState.IdRef="Assign_383">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="479,83" sap2010:WorkflowViewState.IdRef="Assign_384">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="479,189" sap2010:WorkflowViewState.IdRef="AddDataRow_45">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:AddDataRow>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,210" sap2010:WorkflowViewState.IdRef="MultipleAssign_154">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_546">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_547">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_548">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_549">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:MultipleAssign>
                                                                  </Sequence>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_360">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="484,62" sap2010:WorkflowViewState.IdRef="Assign_385">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <If Condition="[arr_Line(1).Contains(&quot;-&quot;)]" sap:VirtualizedContainerService.HintSize="484,222.666666666667" sap2010:WorkflowViewState.IdRef="If_194">
                                                                      <If.Else>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_386">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </If.Else>
                                                                    </If>
                                                                  </Sequence>
                                                                </If.Else>
                                                              </If>
                                                              <ui:IfElseIf x:Key="1" DisplayName="Else If" sap:VirtualizedContainerService.HintSize="501,488" sap2010:WorkflowViewState.IdRef="IfElseIf_10">
                                                                <ui:IfElseIf.ConditionBlocks>
                                                                  <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                    <ui:IfElseIfBlock BlockType="If" Condition="[arr_Line(0).Trim.Length = 13 and Dongia &lt;&gt; &quot;&quot;]">
                                                                      <ui:IfElseIfBlock.Then>
                                                                        <Sequence sap:VirtualizedContainerService.HintSize="450,83" sap2010:WorkflowViewState.IdRef="Sequence_361">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="358,70" sap2010:WorkflowViewState.IdRef="Assign_387">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen, dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="358,198" sap2010:WorkflowViewState.IdRef="AddDataRow_46">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </ui:AddDataRow>
                                                                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="MultipleAssign_155">
                                                                            <ui:MultipleAssign.AssignOperations>
                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_550">
                                                                                  <ui:AssignOperation.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                                  </ui:AssignOperation.To>
                                                                                  <ui:AssignOperation.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </ui:AssignOperation.Value>
                                                                                </ui:AssignOperation>
                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_551">
                                                                                  <ui:AssignOperation.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                                  </ui:AssignOperation.To>
                                                                                  <ui:AssignOperation.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </ui:AssignOperation.Value>
                                                                                </ui:AssignOperation>
                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_552">
                                                                                  <ui:AssignOperation.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                                  </ui:AssignOperation.To>
                                                                                  <ui:AssignOperation.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </ui:AssignOperation.Value>
                                                                                </ui:AssignOperation>
                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_553">
                                                                                  <ui:AssignOperation.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                                  </ui:AssignOperation.To>
                                                                                  <ui:AssignOperation.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </ui:AssignOperation.Value>
                                                                                </ui:AssignOperation>
                                                                              </scg:List>
                                                                            </ui:MultipleAssign.AssignOperations>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </ui:MultipleAssign>
                                                                        </Sequence>
                                                                      </ui:IfElseIfBlock.Then>
                                                                    </ui:IfElseIfBlock>
                                                                    <ui:IfElseIfBlock BlockType="ElseIf" Condition="[arr_Line(0).Trim.Length &lt;&gt; 13]">
                                                                      <ui:IfElseIfBlock.Then>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_388">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(0).Trim]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </ui:IfElseIfBlock.Then>
                                                                    </ui:IfElseIfBlock>
                                                                    <ui:IfElseIfBlock BlockType="Else">
                                                                      <ui:IfElseIfBlock.Then>
                                                                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="450,83" sap2010:WorkflowViewState.IdRef="Sequence_362">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </Sequence>
                                                                      </ui:IfElseIfBlock.Then>
                                                                    </ui:IfElseIfBlock>
                                                                  </sc:BindingList>
                                                                </ui:IfElseIf.ConditionBlocks>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:IfElseIf>
                                                              <If x:Key="3" Condition="[Dongia &lt;&gt; &quot;&quot;]" sap:VirtualizedContainerService.HintSize="334,343" sap2010:WorkflowViewState.IdRef="If_196">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_363">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_389">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_390">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[TenSP + " "+arr_Line(1).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Barcode,TenSP,Soluong,Dongia,PONumber,str_Date,str_Shipto,&quot;4150&quot;,FileName,CusAgen , dateTo}]" DataTable="[dt_Output]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="434,189" sap2010:WorkflowViewState.IdRef="AddDataRow_47">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:AddDataRow>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="434,53" sap2010:WorkflowViewState.IdRef="MultipleAssign_156">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_554">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_555">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_556">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Soluong]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_557">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[Dongia]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:MultipleAssign>
                                                                  </Sequence>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_364">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_391">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[Barcode]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(0).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_392">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[TenSP]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[arr_Line(1).Trim]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </Sequence>
                                                                </If.Else>
                                                              </If>
                                                            </Switch>
                                                          </If.Else>
                                                        </If>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:ForEach.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ForEach>
                                        </Sequence>
                                      </Sequence>
                                      <FlowStep.Next>
                                        <x:Reference>__ReferenceID0</x:Reference>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowDecision.False>
                                </FlowDecision>
                              </FlowStep.Next>
                            </FlowStep>
                            <x:Reference>__ReferenceID1</x:Reference>
                            <x:Reference>__ReferenceID2</x:Reference>
                            <x:Reference>__ReferenceID3</x:Reference>
                            <x:Reference>__ReferenceID4</x:Reference>
                            <x:Reference>__ReferenceID0</x:Reference>
                          </Flowchart>
                        </If.Then>
                        <If.Else>
                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_375">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Sequence>
                        </If.Else>
                      </If>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="672,22" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="558,879.5" sap2010:WorkflowViewState.IdRef="Sequence_378">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="496,143" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Trace" Message="[&quot;BHX   :-&quot;+exception.Message]">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:LogMessage>
                            <Assign sap:VirtualizedContainerService.HintSize="496,83" sap2010:WorkflowViewState.IdRef="Assign_404">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[file_error]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[file_error + FileName + ","]</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Sequence sap:VirtualizedContainerService.HintSize="496,462.5" sap2010:WorkflowViewState.IdRef="Sequence_376">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_405">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[path_error]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[in_Config("Folder_Path").ToString+"\"+Now.ToString("yyyyMM")+"\BHX\Input\Archive\Error - "+filename.ToLower.Replace(".pdf","")+System.DateTime.Now.ToString("_yyyyMMdd-HHmmss") + ".pdf"]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <AddToCollection x:TypeArguments="x:String" Collection="[FileList]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="434,25" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[path_error]" />
                              <ui:MoveFile DestinationResource="{x:Null}" PathResource="{x:Null}" ContinueOnError="True" Destination="[path_error]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="MoveFile_4" Path="[file]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:MoveFile>
                            </Sequence>
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                </Sequence>
              </ActivityAction>
            </ui:ForEach.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:ForEach>
          <Sequence sap:VirtualizedContainerService.HintSize="782,2235" sap2010:WorkflowViewState.IdRef="Sequence_70">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:Boolean" Name="PathExist" />
              <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb_Template" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign sap:VirtualizedContainerService.HintSize="682,83" sap2010:WorkflowViewState.IdRef="Assign_89">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[PathOutput]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_Config("Folder_Path").ToString+"\"+Now.ToString("yyyyMM")+"\BHX\Output\BHX_"+Now.ToString("yyyyMMdd_HH")+".xlsx"]</InArgument>
              </Assign.Value>
            </Assign>
            <If Condition="[dt_Output.Rows.Count&gt;0]" DisplayName="If file error" sap:VirtualizedContainerService.HintSize="682,2001" sap2010:WorkflowViewState.IdRef="If_219">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="648,1818" sap2010:WorkflowViewState.IdRef="Sequence_389">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:FileExistsX DisplayName="File Exists" Exists="[PathExist]" sap:VirtualizedContainerService.HintSize="606,135" sap2010:WorkflowViewState.IdRef="FileExistsX_1" Path="[PathOutput]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:FileExistsX>
                  <If Condition="[PathExist]" sap:VirtualizedContainerService.HintSize="606,53" sap2010:WorkflowViewState.IdRef="If_20">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Else>
                      <Sequence sap:VirtualizedContainerService.HintSize="476,254" sap2010:WorkflowViewState.IdRef="Sequence_78">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:CopyFile ContinueOnError="{x:Null}" Destination="[PathOutput]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="CopyFile_1" Path="Data\Template\UPLOAD_OT ORDER Template.xlsx">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:CopyFile>
                      </Sequence>
                    </If.Else>
                  </If>
                  <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="606,1462" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" InstanceCachePeriod="3000" Workbook="[wb_Template]" WorkbookPath="[PathOutput]">
                    <ui:ExcelApplicationScope.Body>
                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="572,1312" sap2010:WorkflowViewState.IdRef="Sequence_79">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_Template]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="510,60" sap2010:WorkflowViewState.IdRef="ExcelReadRange_1" SheetName="Sheet1">
                            <ui:ExcelReadRange.Range>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </ui:ExcelReadRange.Range>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExcelReadRange>
                          <Assign sap:VirtualizedContainerService.HintSize="510,83" sap2010:WorkflowViewState.IdRef="Assign_81">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">[int_Maxrow]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">[dt_Template.Rows.Count + 1]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="510,83" sap2010:WorkflowViewState.IdRef="Assign_82">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">[int_Count]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">0</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="510,690" sap2010:WorkflowViewState.IdRef="ForEach`1_9" Values="[arr_Column]">
                            <ui:ForEach.Body>
                              <ActivityAction x:TypeArguments="x:String">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="476,502" sap2010:WorkflowViewState.IdRef="Sequence_80">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="sd:DataTable" Name="dt_Filter" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:FilterDataTable DataTable="[dt_Output]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,163" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dt_Filter]" SelectColumnsMode="Keep">
                                    <ui:FilterDataTable.Filters>
                                      <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                        <ui:FilterOperationArgument Column="{x:Null}" Operand="{x:Null}" BooleanOperator="And" Operator="LT" />
                                      </scg:List>
                                    </ui:FilterDataTable.Filters>
                                    <ui:FilterDataTable.SelectColumns>
                                      <scg:List x:TypeArguments="InArgument" Capacity="4">
                                        <InArgument x:TypeArguments="x:Int32">[int_Count]</InArgument>
                                      </scg:List>
                                    </ui:FilterDataTable.SelectColumns>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:FilterDataTable>
                                  <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_Filter]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_1" SheetName="Sheet1" StartingCell="[item+int_Maxrow.ToString]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ExcelWriteRange>
                                  <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_83">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[int_Count]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">[int_Count + 1]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEach.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEach>
                          <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="510,25" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_1" />
                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="510,60" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_1" Workbook="[wb_Template]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExcelCloseWorkbook>
                        </Sequence>
                      </ActivityAction>
                    </ui:ExcelApplicationScope.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExcelApplicationScope>
                </Sequence>
              </If.Then>
              <If.Else>
                <Sequence DisplayName="" sap2010:WorkflowViewState.IdRef="Sequence_391" />
              </If.Else>
            </If>
          </Sequence>
        </Sequence>
      </If.Then>
      <If.Else>
        <Assign sap:VirtualizedContainerService.HintSize="434,83" sap2010:WorkflowViewState.IdRef="Assign_195">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[PathOutput]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">[in_Config("Folder_Path").ToString+"\"+Now.ToString("yyyyMM")+"\BHX\Output\BHX_"+Now.ToString("yyyyMMdd_HH")+".xlsx"]</InArgument>
          </Assign.Value>
        </Assign>
      </If.Else>
    </If>
  </Sequence>
</Activity>